CREATE TABLE user (
  id BIGINT PRIMARY KEY AUTO_INCREMENT,
  name VARCHAR(10) NOT NULL UNIQUE,
  password VARCHAR(10) NOT NULL,
  created_time DATETIME DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE game (
  id BIGINT PRIMARY KEY AUTO_INCREMENT,
  turn VARCHAR(10) NOT NULL DEFAULT "white",
  is_finished TINYINT(1) NOT NULL DEFAULT 0,
  created_time DATETIME DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE piece (
  id BIGINT PRIMARY KEY AUTO_INCREMENT,
  game_id BIGINT NOT NULL,
  shape VARCHAR(1) NOT NULL,
  color VARCHAR(10) NOT NULL,
  x INT NOT NULL,
  y INT NOT NULL,
  FOREIGN KEY(game_id) REFERENCES game(id) ON UPDATE CASCADE ON DELETE RESTRICT
);

CREATE TABLE room (
  id BIGINT PRIMARY KEY AUTO_INCREMENT,
  game_id BIGINT NOT NULL,
  host_id BIGINT NOT NULL,
  guest_id BIGINT,
  name VARCHAR(10) NOT NULL,
  FOREIGN KEY(game_id) REFERENCES game(id) ON UPDATE CASCADE ON DELETE RESTRICT,
  FOREIGN KEY(host_id) REFERENCES user(id) ON UPDATE CASCADE ON DELETE RESTRICT,
  FOREIGN KEY(guest_id) REFERENCES user(id) ON UPDATE CASCADE ON DELETE RESTRICT
);
