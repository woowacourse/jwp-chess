<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>체스 게임</title>
    <link rel="stylesheet" href="/src/index.css">
</head>
<body>
<div class="lobby">
    <h1>체스 게임 대기실</h1>
    <div class="create-room">
        <form action="/chess-game" method="post">
            <input type="hidden" name="id" value="{{id}}"/>
            <input type="text" name="name" placeholder="방 이름을 입력하세요."/>
            <input type="password" name="password" placeholder="비밀번호를 입력해주세요."/>
            <input type="submit" value="생성">
        </form>
    </div>
    <br>
    <div class="rooms">
        <table>
            <tr>
                <th>방 번호</th>
                <th>방 이름</th>
                <th>참 가</th>
            </tr>
            {{#chess-games}}
            <tr>
                <td>{{id}}</td>
                <td>{{name}}</td>
                <td>
                    <input type="button" value="참가" onclick="joinRoom('{{id}}')"/>
                </td>
                <td>
                    <input type="button" value="삭제" onclick="deleteRoom('{{id}}')"/>
                </td>
            </tr>
            {{/chess-games}}
        </table>
    </div>
</body>
</div>

<script>
    function joinRoom(id) {
        window.location.replace("/chess-game/" + id);
    }

    async function deleteRoom(id) {
        const password = prompt('비밀번호를 입력해주세요.', "비밀번호를 입력해주세요.");
        await fetch("/chess-game/" + id, {
            method: 'DELETE',
            headers: {
                "Authorization": password,
            },
        });
        window.location.replace("/");
    }
</script>
</html>
